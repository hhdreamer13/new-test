{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from\"react\";import Joi from\"joi-browser\";import Form from\"./common/form\";import{getMovie,saveMovie}from\"../services/movieService\";import{getGenres}from\"../services/genreService\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MovieForm=/*#__PURE__*/function(_Form){_inherits(MovieForm,_Form);var _super=_createSuper(MovieForm);function MovieForm(){var _this;_classCallCheck(this,MovieForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:{title:\"\",genreId:\"\",numberInStock:\"\",dailyRentalRate:\"\"},genres:[],errors:{}};_this.schema={_id:Joi.string(),title:Joi.string().required().label(\"Title\"),genreId:Joi.string().required().label(\"Genre\"),numberInStock:Joi.number().required().min(0).max(100).label(\"Stock\"),dailyRentalRate:Joi.number().required().min(0).max(100).label(\"Rate\")};_this.doSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return saveMovie(_this.state.data);case 2:_this.props.history.push(\"/movies\");case 3:case\"end\":return _context.stop();}}},_callee);}));return _this;}_createClass(MovieForm,[{key:\"populateGenres\",value:function(){var _populateGenres=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$getGenres,genres;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getGenres();case 2:_yield$getGenres=_context2.sent;genres=_yield$getGenres.data;this.setState({genres:genres});case 5:case\"end\":return _context2.stop();}}},_callee2,this);}));function populateGenres(){return _populateGenres.apply(this,arguments);}return populateGenres;}()},{key:\"populateMovie\",value:function(){var _populateMovie=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var movieId,_yield$getMovie,movie;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;movieId=this.props.match.params.id;if(!(movieId===\"new\")){_context3.next=4;break;}return _context3.abrupt(\"return\");case 4:_context3.next=6;return getMovie(movieId);case 6:_yield$getMovie=_context3.sent;movie=_yield$getMovie.data;this.setState({data:this.mapToViewModel(movie)});_context3.next=14;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](0);if(_context3.t0.response&&_context3.t0.response.status===404)// I get 500 instead\nthis.props.history.replace(\"/not-found\");case 14:case\"end\":return _context3.stop();}}},_callee3,this,[[0,11]]);}));function populateMovie(){return _populateMovie.apply(this,arguments);}return populateMovie;}()},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.populateGenres();case 2:_context4.next=4;return this.populateMovie();case 4:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"mapToViewModel\",value:function mapToViewModel(movie){return{_id:movie._id,title:movie.title,genreId:movie.genre._id,numberInStock:movie.numberInStock,dailyRentalRate:movie.dailyRentalRate};}},{key:\"render\",value:function render(){var _this$props=this.props,match=_this$props.match,history=_this$props.history;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Movie Form \",match.params.id]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,children:[this.renderInput(\"title\",\"Title\"),this.renderSelect(\"genreId\",\"Genre\",this.state.genres),this.renderInput(\"numberInStock\",\"Stock\",\"number\"),this.renderInput(\"dailyRentalRate\",\"Rental\",\"number\"),this.renderButton(\"Save\")]})]});}}]);return MovieForm;}(Form);export default MovieForm;","map":{"version":3,"names":["React","Component","Joi","Form","getMovie","saveMovie","getGenres","MovieForm","state","data","title","genreId","numberInStock","dailyRentalRate","genres","errors","schema","_id","string","required","label","number","min","max","doSubmit","props","history","push","setState","movieId","match","params","id","movie","mapToViewModel","response","status","replace","populateGenres","populateMovie","genre","handleSubmit","renderInput","renderSelect","renderButton"],"sources":["/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/src/components/movieForm.jsx"],"sourcesContent":["import React, { Component } from \"react\";\nimport Joi from \"joi-browser\";\nimport Form from \"./common/form\";\nimport { getMovie, saveMovie } from \"../services/movieService\";\nimport { getGenres } from \"../services/genreService\";\n\nclass MovieForm extends Form {\n  state = {\n    data: { title: \"\", genreId: \"\", numberInStock: \"\", dailyRentalRate: \"\" },\n    genres: [],\n    errors: {},\n  };\n\n  schema = {\n    _id: Joi.string(),\n    title: Joi.string().required().label(\"Title\"),\n    genreId: Joi.string().required().label(\"Genre\"),\n    numberInStock: Joi.number().required().min(0).max(100).label(\"Stock\"),\n    dailyRentalRate: Joi.number().required().min(0).max(100).label(\"Rate\"),\n  };\n\n  async populateGenres() {\n    const { data: genres } = await getGenres();\n    this.setState({ genres });\n  }\n\n  async populateMovie() {\n    try {\n      const movieId = this.props.match.params.id;\n      if (movieId === \"new\") return;\n      const { data: movie } = await getMovie(movieId);\n      this.setState({ data: this.mapToViewModel(movie) });\n    } catch (ex) {\n      if (ex.response && ex.response.status === 404)\n        // I get 500 instead\n        this.props.history.replace(\"/not-found\");\n    }\n  }\n\n  async componentDidMount() {\n    await this.populateGenres();\n    await this.populateMovie();\n  }\n\n  mapToViewModel(movie) {\n    return {\n      _id: movie._id,\n      title: movie.title,\n      genreId: movie.genre._id,\n      numberInStock: movie.numberInStock,\n      dailyRentalRate: movie.dailyRentalRate,\n    };\n  }\n\n  doSubmit = async () => {\n    await saveMovie(this.state.data);\n\n    this.props.history.push(\"/movies\");\n  };\n\n  render() {\n    const { match, history } = this.props;\n    return (\n      <div>\n        <h1>Movie Form {match.params.id}</h1>\n        <form onSubmit={this.handleSubmit}>\n          {this.renderInput(\"title\", \"Title\")}\n          {this.renderSelect(\"genreId\", \"Genre\", this.state.genres)}\n          {this.renderInput(\"numberInStock\", \"Stock\", \"number\")}\n          {this.renderInput(\"dailyRentalRate\", \"Rental\", \"number\")}\n          {this.renderButton(\"Save\")}\n        </form>\n        {/* <button\n          className='btn btn-primary'\n          onClick={() => history.push(\"/movies\")}\n        >\n          Save\n        </button> */}\n      </div>\n    );\n  }\n}\n\nexport default MovieForm;\n"],"mappings":"szBAAA,MAAOA,MAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,MAAOC,IAAG,KAAM,aAAa,CAC7B,MAAOC,KAAI,KAAM,eAAe,CAChC,OAASC,QAAQ,CAAEC,SAAS,KAAQ,0BAA0B,CAC9D,OAASC,SAAS,KAAQ,0BAA0B,CAAC,gDAE/CC,UAAS,6TACbC,KAAK,CAAG,CACNC,IAAI,CAAE,CAAEC,KAAK,CAAE,EAAE,CAAEC,OAAO,CAAE,EAAE,CAAEC,aAAa,CAAE,EAAE,CAAEC,eAAe,CAAE,EAAG,CAAC,CACxEC,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,CAAC,CACX,CAAC,OAEDC,MAAM,CAAG,CACPC,GAAG,CAAEf,GAAG,CAACgB,MAAM,EAAE,CACjBR,KAAK,CAAER,GAAG,CAACgB,MAAM,EAAE,CAACC,QAAQ,EAAE,CAACC,KAAK,CAAC,OAAO,CAAC,CAC7CT,OAAO,CAAET,GAAG,CAACgB,MAAM,EAAE,CAACC,QAAQ,EAAE,CAACC,KAAK,CAAC,OAAO,CAAC,CAC/CR,aAAa,CAAEV,GAAG,CAACmB,MAAM,EAAE,CAACF,QAAQ,EAAE,CAACG,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,CAACH,KAAK,CAAC,OAAO,CAAC,CACrEP,eAAe,CAAEX,GAAG,CAACmB,MAAM,EAAE,CAACF,QAAQ,EAAE,CAACG,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,CAACH,KAAK,CAAC,MAAM,CACvE,CAAC,OAmCDI,QAAQ,wEAAG,2JACHnB,UAAS,CAAC,MAAKG,KAAK,CAACC,IAAI,CAAC,QAEhC,MAAKgB,KAAK,CAACC,OAAO,CAACC,IAAI,CAAC,SAAS,CAAC,CAAC,sDACpC,8JArCD,6LACiCrB,UAAS,EAAE,wCAA5BQ,MAAM,kBAAZL,IAAI,CACZ,IAAI,CAACmB,QAAQ,CAAC,CAAEd,MAAM,CAANA,MAAO,CAAC,CAAC,CAAC,6DAC3B,yNAED,6LAEUe,OAAO,CAAG,IAAI,CAACJ,KAAK,CAACK,KAAK,CAACC,MAAM,CAACC,EAAE,MACtCH,OAAO,GAAK,KAAK,2FACSzB,SAAQ,CAACyB,OAAO,CAAC,uCAAjCI,KAAK,iBAAXxB,IAAI,CACZ,IAAI,CAACmB,QAAQ,CAAC,CAAEnB,IAAI,CAAE,IAAI,CAACyB,cAAc,CAACD,KAAK,CAAE,CAAC,CAAC,CAAC,qFAEpD,GAAI,aAAGE,QAAQ,EAAI,aAAGA,QAAQ,CAACC,MAAM,GAAK,GAAG,CAC3C;AACA,IAAI,CAACX,KAAK,CAACC,OAAO,CAACW,OAAO,CAAC,YAAY,CAAC,CAAC,uEAE9C,8NAED,iKACQ,KAAI,CAACC,cAAc,EAAE,+BACrB,KAAI,CAACC,aAAa,EAAE,8DAC3B,2IAED,wBAAeN,KAAK,CAAE,CACpB,MAAO,CACLhB,GAAG,CAAEgB,KAAK,CAAChB,GAAG,CACdP,KAAK,CAAEuB,KAAK,CAACvB,KAAK,CAClBC,OAAO,CAAEsB,KAAK,CAACO,KAAK,CAACvB,GAAG,CACxBL,aAAa,CAAEqB,KAAK,CAACrB,aAAa,CAClCC,eAAe,CAAEoB,KAAK,CAACpB,eACzB,CAAC,CACH,CAAC,sBAQD,iBAAS,CACP,gBAA2B,IAAI,CAACY,KAAK,CAA7BK,KAAK,aAALA,KAAK,CAAEJ,OAAO,aAAPA,OAAO,CACtB,mBACE,oCACE,oCAAgBI,KAAK,CAACC,MAAM,CAACC,EAAE,GAAM,cACrC,cAAM,QAAQ,CAAE,IAAI,CAACS,YAAa,WAC/B,IAAI,CAACC,WAAW,CAAC,OAAO,CAAE,OAAO,CAAC,CAClC,IAAI,CAACC,YAAY,CAAC,SAAS,CAAE,OAAO,CAAE,IAAI,CAACnC,KAAK,CAACM,MAAM,CAAC,CACxD,IAAI,CAAC4B,WAAW,CAAC,eAAe,CAAE,OAAO,CAAE,QAAQ,CAAC,CACpD,IAAI,CAACA,WAAW,CAAC,iBAAiB,CAAE,QAAQ,CAAE,QAAQ,CAAC,CACvD,IAAI,CAACE,YAAY,CAAC,MAAM,CAAC,GACrB,GAOH,CAEV,CAAC,uBA1EqBzC,IAAI,EA6E5B,cAAeI,UAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}