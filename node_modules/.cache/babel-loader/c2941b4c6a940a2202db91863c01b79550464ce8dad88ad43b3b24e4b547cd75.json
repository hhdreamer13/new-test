{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import Joi from\"joi-browser\";import Form from\"./common/form\";import auth from\"../services/authService\";import{Redirect}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginForm=/*#__PURE__*/function(_Form){_inherits(LoginForm,_Form);var _super=_createSuper(LoginForm);function LoginForm(){var _this;_classCallCheck(this,LoginForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:{username:\"\",password:\"\"},errors:{}};_this.schema={username:Joi.string().min(5).required().label(\"Username\"),password:Joi.string().min(5).required().label(\"Password\")};_this.doSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var data,test,state,errors;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;data=_this.state.data;_context.next=4;return auth.login(data.username,data.password);case 4:test=_context.sent;console.log(test);state=_this.props.location.state;window.location=state?state.from.pathname:\"/\";_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);if(_context.t0.response&&_context.t0.response.status===400){errors=_objectSpread({},_this.state.errors);errors.username=_context.t0.response.data;_this.setState({errors:errors});}case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return _this;}_createClass(LoginForm,[{key:\"render\",value:function render(){if(auth.getCurrentUser())return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,children:[this.renderInput(\"username\",\"Username\"),this.renderInput(\"password\",\"Password\",\"password\"),this.renderButton(\"Login\")]})]});}}]);return LoginForm;}(Form);export default LoginForm;","map":{"version":3,"names":["React","Joi","Form","auth","Redirect","LoginForm","state","data","username","password","errors","schema","string","min","required","label","doSubmit","login","test","console","log","props","location","window","from","pathname","response","status","setState","getCurrentUser","handleSubmit","renderInput","renderButton"],"sources":["/Users/hooman/Desktop/Hh Coding/_iCoding/Demo/vidly/src/components/loginForm.jsx"],"sourcesContent":["import React from \"react\";\nimport Joi from \"joi-browser\";\nimport Form from \"./common/form\";\nimport auth from \"../services/authService\";\nimport { Redirect } from \"react-router-dom\";\n\nclass LoginForm extends Form {\n  state = {\n    data: { username: \"\", password: \"\" },\n    errors: {},\n  };\n\n  schema = {\n    username: Joi.string().min(5).required().label(\"Username\"),\n    password: Joi.string().min(5).required().label(\"Password\"),\n  };\n\n  doSubmit = async () => {\n    try {\n      const { data } = this.state;\n      const test = await auth.login(data.username, data.password);\n      console.log(test);\n      const { state } = this.props.location;\n      window.location = state ? state.from.pathname : \"/\";\n    } catch (ex) {\n      if (ex.response && ex.response.status === 400) {\n        const errors = { ...this.state.errors };\n        errors.username = ex.response.data;\n        this.setState({ errors });\n      }\n    }\n  };\n\n  render() {\n    if (auth.getCurrentUser()) return <Redirect to='/' />;\n    return (\n      <div>\n        <h1>Login</h1>\n        <form onSubmit={this.handleSubmit}>\n          {this.renderInput(\"username\", \"Username\")}\n          {this.renderInput(\"password\", \"Password\", \"password\")}\n          {this.renderButton(\"Login\")}\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default LoginForm;\n"],"mappings":"87BAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,MAAOC,IAAG,KAAM,aAAa,CAC7B,MAAOC,KAAI,KAAM,eAAe,CAChC,MAAOC,KAAI,KAAM,yBAAyB,CAC1C,OAASC,QAAQ,KAAQ,kBAAkB,CAAC,2FAEtCC,UAAS,6TACbC,KAAK,CAAG,CACNC,IAAI,CAAE,CAAEC,QAAQ,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAG,CAAC,CACpCC,MAAM,CAAE,CAAC,CACX,CAAC,OAEDC,MAAM,CAAG,CACPH,QAAQ,CAAEP,GAAG,CAACW,MAAM,EAAE,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,QAAQ,EAAE,CAACC,KAAK,CAAC,UAAU,CAAC,CAC1DN,QAAQ,CAAER,GAAG,CAACW,MAAM,EAAE,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,QAAQ,EAAE,CAACC,KAAK,CAAC,UAAU,CAC3D,CAAC,OAEDC,QAAQ,wEAAG,gLAECT,IAAI,CAAK,MAAKD,KAAK,CAAnBC,IAAI,uBACOJ,KAAI,CAACc,KAAK,CAACV,IAAI,CAACC,QAAQ,CAAED,IAAI,CAACE,QAAQ,CAAC,QAArDS,IAAI,eACVC,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC,CACTZ,KAAK,CAAK,MAAKe,KAAK,CAACC,QAAQ,CAA7BhB,KAAK,CACbiB,MAAM,CAACD,QAAQ,CAAGhB,KAAK,CAAGA,KAAK,CAACkB,IAAI,CAACC,QAAQ,CAAG,GAAG,CAAC,iFAEpD,GAAI,YAAGC,QAAQ,EAAI,YAAGA,QAAQ,CAACC,MAAM,GAAK,GAAG,CAAE,CACvCjB,MAAM,kBAAQ,MAAKJ,KAAK,CAACI,MAAM,EACrCA,MAAM,CAACF,QAAQ,CAAG,YAAGkB,QAAQ,CAACnB,IAAI,CAClC,MAAKqB,QAAQ,CAAC,CAAElB,MAAM,CAANA,MAAO,CAAC,CAAC,CAC3B,CAAC,qEAEJ,6DAED,iBAAS,CACP,GAAIP,IAAI,CAAC0B,cAAc,EAAE,CAAE,mBAAO,KAAC,QAAQ,EAAC,EAAE,CAAC,GAAG,EAAG,CACrD,mBACE,oCACE,6BAAc,cACd,cAAM,QAAQ,CAAE,IAAI,CAACC,YAAa,WAC/B,IAAI,CAACC,WAAW,CAAC,UAAU,CAAE,UAAU,CAAC,CACxC,IAAI,CAACA,WAAW,CAAC,UAAU,CAAE,UAAU,CAAE,UAAU,CAAC,CACpD,IAAI,CAACC,YAAY,CAAC,OAAO,CAAC,GACtB,GACH,CAEV,CAAC,uBAvCqB9B,IAAI,EA0C5B,cAAeG,UAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}